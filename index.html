<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>续保费用变化提醒</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            color: #1a1a1a;
            text-align: center;
            margin-bottom: 30px;
        }

        .search-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        input[type="date"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            color: #333;
            flex: 1;
        }

        .toggle-weeks {
            padding: 8px 16px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            color: #333;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toggle-weeks:hover {
            background: #f8f9fa;
        }

        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .month-group {
            width: 100%;
            margin-bottom: 10px;
        }

        .month-title {
            font-weight: bold;
            margin: 10px 0;
            padding: 5px;
            background: #f5f5f5;
            border-radius: 4px;
        }

        .week-btn {
            padding: 6px 12px;
            margin: 4px;
            border: 1px solid #ddd;
            border-radius: 4px; 
            background: #fff;
            font-size: 14px;
            color: #333;
            cursor: pointer;
        }

        .week-btn.active {
            background: #f0f0f0;
            border-color: #ccc;
        }

        .guide-card {
            background: #fff;
            border-radius: 8px;
            padding: 24px;
            margin: 15px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .date {
            font-size: 22px;
            color: #1a1a1a;
            margin-bottom: 16px;
            font-weight: 600;
        }

        .renewal-period {
            font-size: 16px;
            color: #595959;
            margin-bottom: 20px;
        }

        .renewal-period div {
            margin-bottom: 8px;
        }

        .renewal-types {
            color: #666;
            font-size: 15px;
        }

        .investment-rates {
            font-size: 16px;
            color: #262626;
            line-height: 1.8;
        }

        .rate-item {
            margin-bottom: 12px;
        }

        .highlight {
            color: #1890ff;
            font-weight: 500;
        }

        .countdown {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 15px rgba(33, 150, 243, 0.2);
        }

        .countdown-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #ffffff;
            font-weight: 500;
        }

        .countdown-display {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .countdown-item {
            text-align: center;
        }

        .countdown-number {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            background: rgba(255,255,255,0.15);
            padding: 8px 12px;
            border-radius: 6px;
            min-width: 40px;
            display: inline-block;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .countdown-label {
            font-size: 12px;
            color: rgba(255,255,255,0.9);
            margin-top: 5px;
            font-weight: 500;
        }

        .countdown-details {
            font-size: 14px;
            line-height: 1.6;
            color: rgba(255,255,255,0.95);
            text-align: left;
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 15px;
            margin-top: 15px;
        }

        .countdown-details div {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .countdown-details div:before {
            content: "•";
            position: absolute;
            left: 5px;
            color: rgba(255,255,255,0.9);
        }

        .special-notice {
            background: #fff3e0;
            border: 1px solid #ffb74d;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            color: #e65100;
            font-size: 15px;
            line-height: 1.6;
        }

        .special-notice div {
            margin: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .special-notice div:before {
            content: "•";
            position: absolute;
            left: 5px;
        }

        .no-rate {
            color: #ff4d4f;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>续保费用变化提醒</h1>
        <div id="countdown-container"></div>
        <div class="search-container">
            <input type="date" id="dateSearch" onchange="searchDate()">
            <button class="toggle-weeks" onclick="toggleWeeks()">按日期查看</button>
        </div>
        <div class="nav-buttons" style="display: none;">
            <div class="month-group">
                <div class="month-title">2024年12月</div>
                <button onclick="showDate('2024-12-03')" class="week-btn">12月3日</button>
                <button onclick="showDate('2024-12-04')" class="week-btn">12月4日</button>
                <button onclick="showDate('2024-12-05')" class="week-btn">12月5日</button>
                <button onclick="showDate('2024-12-06')" class="week-btn">12月6日</button>
                <button onclick="showDate('2024-12-07')" class="week-btn">12月7日</button>
                <button onclick="showDate('2024-12-08')" class="week-btn">12月8日</button>
                <button onclick="showDate('2024-12-09')" class="week-btn">12月9日</button>
                <button onclick="showDate('2024-12-10')" class="week-btn">12月10日</button>
                <button onclick="showDate('2024-12-11')" class="week-btn">12月11日</button>
                <button onclick="showDate('2024-12-12')" class="week-btn">12月12日</button>
                <button onclick="showDate('2024-12-13')" class="week-btn">12月13日</button>
                <button onclick="showDate('2024-12-14')" class="week-btn">12月14日</button>
                <button onclick="showDate('2024-12-15')" class="week-btn">12月15日</button>
                <button onclick="showDate('2024-12-16')" class="week-btn">12月16日</button>
                <button onclick="showDate('2024-12-17')" class="week-btn">12月17日</button>
                <button onclick="showDate('2024-12-18')" class="week-btn">12月18日</button>
                <button onclick="showDate('2024-12-19')" class="week-btn">12月19日</button>
                <button onclick="showDate('2024-12-20')" class="week-btn">12月20日</button>
                <button onclick="showDate('2024-12-21')" class="week-btn">12月21日</button>
                <button onclick="showDate('2024-12-22')" class="week-btn">12月22日</button>
                <button onclick="showDate('2024-12-23')" class="week-btn">12月23日</button>
                <button onclick="showDate('2024-12-24')" class="week-btn">12月24日</button>
                <button onclick="showDate('2024-12-25')" class="week-btn">12月25日</button>
                <button onclick="showDate('2024-12-26')" class="week-btn">12月26日</button>
                <button onclick="showDate('2024-12-27')" class="week-btn">12月27日</button>
                <button onclick="showDate('2024-12-28')" class="week-btn">12月28日</button>
                <button onclick="showDate('2024-12-29')" class="week-btn">12月29日</button>
                <button onclick="showDate('2024-12-30')" class="week-btn">12月30日</button>
                <button onclick="showDate('2024-12-31')" class="week-btn">12月31日</button>
            </div>
            <div class="month-group">
                <div class="month-title">2025年1月</div>
                <button onclick="showDate('2025-01-01')" class="week-btn">1月1日</button>
                <button onclick="showDate('2025-01-02')" class="week-btn">1月2日</button>
                <button onclick="showDate('2025-01-03')" class="week-btn">1月3日</button>
                <button onclick="showDate('2025-01-04')" class="week-btn">1月4日</button>
                <button onclick="showDate('2025-01-05')" class="week-btn">1月5日</button>
                <button onclick="showDate('2025-01-06')" class="week-btn">1月6日</button>
                <button onclick="showDate('2025-01-07')" class="week-btn">1月7日</button>
                <button onclick="showDate('2025-01-08')" class="week-btn">1月8日</button>
                <button onclick="showDate('2025-01-09')" class="week-btn">1月9日</button>
                <button onclick="showDate('2025-01-10')" class="week-btn">1月10日</button>
                <button onclick="showDate('2025-01-11')" class="week-btn">1月11日</button>
                <button onclick="showDate('2025-01-12')" class="week-btn">1月12日</button>
                <button onclick="showDate('2025-01-13')" class="week-btn">1月13日</button>
                <button onclick="showDate('2025-01-14')" class="week-btn">1月14日</button>
                <button onclick="showDate('2025-01-15')" class="week-btn">1月15日</button>
                <button onclick="showDate('2025-01-16')" class="week-btn">1月16日</button>
                <button onclick="showDate('2025-01-17')" class="week-btn">1月17日</button>
                <button onclick="showDate('2025-01-18')" class="week-btn">1月18日</button>
                <button onclick="showDate('2025-01-19')" class="week-btn">1月19日</button>
                <button onclick="showDate('2025-01-20')" class="week-btn">1月20日</button>
                <button onclick="showDate('2025-01-21')" class="week-btn">1月21日</button>
                <button onclick="showDate('2025-01-22')" class="week-btn">1月22日</button>
                <button onclick="showDate('2025-01-23')" class="week-btn">1月23日</button>
                <button onclick="showDate('2025-01-24')" class="week-btn">1月24日</button>
                <button onclick="showDate('2025-01-25')" class="week-btn">1月25日</button>
                <button onclick="showDate('2025-01-26')" class="week-btn">1月26日</button>
                <button onclick="showDate('2025-01-27')" class="week-btn">1月27日</button>
                <button onclick="showDate('2025-01-28')" class="week-btn">1月28日</button>
                <button onclick="showDate('2025-01-29')" class="week-btn">1月29日</button>
                <button onclick="showDate('2025-01-30')" class="week-btn">1月30日</button>
                <button onclick="showDate('2025-01-31')" class="week-btn">1月31日</button>
            </div>
        </div>
        <div id="guides-container"></div>
    </div>

    <script>
        const weekRanges = {
            1: { start: '2024-12-26', end: '2024-12-31' },
            2: { start: '2025-01-01', end: '2025-01-04' }
        };

        function getCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function generateGuideHTML(date) {
            const dateObj = new Date(date);
            const renewalStart = addDays(dateObj, 1);
            const renewalEnd = addDays(dateObj, 30);
            
            let ratesHTML = '';
            const cutoffDate = new Date('2024-12-16');
            
            if (dateObj < cutoffDate) {
                // 12月15日及之前的规则
                ratesHTML = `
                    <div class="rate-item">2025年起保的保单增投 <span class="highlight">+5%</span></div>
                    <div class="rate-item">2024年起保的保单增投 <span class="highlight">+3%</span></div>
                `;
                
                // 12月15日显示特殊提醒
                if (date === '2024-12-15') {
                    ratesHTML += `
                        <div class="special-notice">
                            <div>明日起，12月16日至12月25日的保单增投从5%降至3%</div>
                            <div>明日起，12月25日之前的保单增投将降至0%</div>
                            <div>请及时处理相关保单，以免错过最佳增投机会</div>
                        </div>
                    `;
                }
            } else {
                // 计算三个日期区间
                const highDate = addDays(renewalStart, 19);  // 20天后及之后
                const midDateEnd = highDate;
                const midDateStart = addDays(renewalStart, 9);  // 10-19天
                const lowDate = midDateStart;  // 9天及之前

                ratesHTML = `
                    <div class="rate-item">${formatDate(highDate)}及之后到期的保单增投 <span class="highlight">+5%</span></div>
                    <div class="rate-item">${formatDate(midDateStart)}至${formatDate(midDateEnd)}到期的保单增投 <span class="highlight">+3%</span></div>
                    <div class="rate-item no-rate">${formatDate(addDays(lowDate, -1))}及之前到期的保单没有增投</div>
                `;
            }

            return `
                <div class="guide-card" id="${date}">
                    <div class="date">
                        ${formatDate(dateObj)}续保费用变化提醒
                    </div>
                    <div class="renewal-period">
                        <div>今日可续：${formatDate(renewalStart)}至${formatDate(renewalEnd)}</div>
                        <div>增投对象：燃油、家自车、商业险、续保</div>
                        <div class="renewal-types">请优先续保增投比例高的客户</div>
                    </div>
                    <div class="investment-rates">
                        ${ratesHTML}
                    </div>
                </div>
            `;
        }

        function formatDate(date, format = 'chinese') {
            if (format === 'chinese') {
                const year = date.getFullYear();
                return `${year}年${date.getMonth() + 1}月${date.getDate()}日`;
            }
            return date.toISOString().split('T')[0];
        }

        function addDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + days);
            return result;
        }

        function showDate(date) {
            // 更新按钮状态
            document.querySelectorAll('.week-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`button[onclick="showDate('${date}')"]`).classList.add('active');
            
            // 隐藏所有指南卡片
            const allGuides = document.querySelectorAll('.guide-card');
            allGuides.forEach(guide => {
                guide.style.display = 'none';
            });
            
            // 显示选中日期的卡片
            const guide = document.getElementById(date);
            if (guide) {
                guide.style.display = 'block';
            }
            
            // 更新日期选择器
            document.getElementById('dateSearch').value = date;
        }

        function toggleWeeks() {
            const navButtons = document.querySelector('.nav-buttons');
            navButtons.style.display = navButtons.style.display === 'none' ? 'block' : 'none';
        }

        function searchDate() {
            const date = document.getElementById('dateSearch').value;
            showDate(date);
        }

        // 页面加载时初始化
        window.onload = function() {
            const dateSearch = document.getElementById('dateSearch');
            const currentDate = getCurrentDate();
            
            // 设置日期选择器的范围
            dateSearch.min = '2024-12-03';
            dateSearch.max = '2025-01-31';
            
            // 设置当前日期
            dateSearch.value = currentDate;
            
            // 生成所有指南卡片
            const startDate = new Date('2024-12-03');
            const endDate = new Date('2025-01-31');
            const guidesContainer = document.getElementById('guides-container');
            
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                const dateStr = formatDate(d, 'iso');
                const guideHTML = generateGuideHTML(dateStr);
                guidesContainer.innerHTML += guideHTML;
            }
            
            // 只显示当天的内容
            const allGuides = document.querySelectorAll('.guide-card');
            allGuides.forEach(guide => {
                guide.style.display = 'none';
            });
            
            // 显示当前日期的内容
            showDate(currentDate);

            // 添加倒计时（如果在有效期内）
            const countdownContainer = document.getElementById('countdown-container');
            const countdownElement = updateCountdown();
            if (countdownElement) {
                countdownContainer.appendChild(countdownElement);
            }
        };

        function updateCountdown() {
            const targetDate = new Date('2024-12-16T00:00:00');
            const countdownElement = document.createElement('div');
            countdownElement.className = 'countdown';
            
            function formatNumber(number) {
                return number < 10 ? '0' + number : number;
            }
            
            function updateTimer() {
                const now = new Date();
                const timeDiff = targetDate - now;
                
                if (timeDiff > 0) {
                    const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                    
                    countdownElement.innerHTML = `
                        <div class="countdown-title">费用下降倒计时</div>
                        <div class="countdown-display">
                            <div class="countdown-item">
                                <div class="countdown-number">${formatNumber(days)}</div>
                                <div class="countdown-label">天</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number">${formatNumber(hours)}</div>
                                <div class="countdown-label">时</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number">${formatNumber(minutes)}</div>
                                <div class="countdown-label">分</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number">${formatNumber(seconds)}</div>
                                <div class="countdown-label">秒</div>
                            </div>
                        </div>
                        <div class="countdown-details">
                            <div>12月16日起，12月16日至12月25日的保单增投从5%降至3%</div>
                            <div>12月16日起，12月25日之前的保单增投将降至0%</div>
                            <div>请及时处理相关保单，以免错过最佳增投机会</div>
                        </div>
                    `;
                } else {
                    countdownElement.style.display = 'none';
                }
            }
            
            // 初始更新
            updateTimer();
            // 每秒更新一次
            setInterval(updateTimer, 1000);
            
            return countdownElement;
        }
    </script>
</body>
</html>